# 429跳过功能文档

## 功能概述

新增的`--skip-429`参数允许用户在遇到429错误（Too Many Requests）或CAPTCHA时，执行除浏览器手动处理外的所有自动化策略。这个功能特别适合需要快速爬取、但仍希望尝试自动化解决方案的场景。

## 🔄 智能跳过策略

在`--skip-429`模式下，系统会：

**✅ 仍然执行的策略：**

- 自动重试机制
- 指数退避延迟
- 请求头更新（User-Agent等）
- 短暂延迟后重试
- 基础的反爬虫规避策略

**❌ 跳过的策略：**

- 浏览器窗口弹出
- 手动CAPTCHA处理
- 用户交互干预

## 使用方法

### 命令行使用

```bash
# 启用智能跳过模式
python enhanced_demo.py --url "your_url" --skip-429

# 极速模式组合
python enhanced_demo.py --url "your_url" --skip-429 --no-delays --no-browser
```

### 编程接口

```python
crawler = GoogleScholarCrawler(
    max_depth=3,
    max_papers_per_level=5,
    skip_429_errors=True  # 启用智能跳过模式
)
```

## 功能特点

### ✅ 优点

1. **智能处理**: 仍然尝试所有自动化策略
2. **无人值守**: 不需要手动干预处理CAPTCHA
3. **提升成功率**: 通过重试和延迟策略增加成功机会
4. **适度快速**: 比完全跳过更可靠，比手动处理更快速

### ⚠️ 注意事项

1. **成功率**: 自动化策略可能无法解决所有问题
2. **延迟增加**: 重试策略会增加总处理时间
3. **适用场景**: 适合对数据完整性有一定要求但不需要100%完整的场景

## 使用场景

### 适合使用

- 需要平衡速度和成功率的爬取
- 批量处理中的智能处理
- 无人值守的自动化任务
- 对部分数据丢失可以容忍的场景

### 不适合使用

- 需要100%数据完整性的学术研究
- 重要论文的完整分析
- 需要手动验证每个步骤的场景

## 工作原理

### 默认模式 (skip_429_errors=False)

```
429/CAPTCHA错误 → 尝试自动策略 → 浏览器手动处理 → 用户干预 → 继续爬取
```

### 智能跳过模式 (skip_429_errors=True)

```
429/CAPTCHA错误 → 尝试自动策略 → 记录日志 → 继续下一个URL
```

## 日志输出

### 智能跳过模式示例

```
🚨 检测到429错误 (Too Many Requests)
🔄 执行429错误处理策略...
   ✓ 已更新User-Agent
   ✓ 执行退避延迟: 4 秒
⏭️  429跳过模式已启用，跳过浏览器手动处理
   ✓ 已执行所有自动化策略，继续后续处理
```

## 配置示例

### 推荐配置组合

```bash
# 智能跳过 + 保守延迟（推荐）
python enhanced_demo.py --url "your_url" --skip-429

# 智能跳过 + 激进延迟（提高成功率）
python enhanced_demo.py --url "your_url" --skip-429 --aggressive-delays

# 智能跳过 + 快速模式（提高速度）
python enhanced_demo.py --url "your_url" --skip-429 --no-delays --no-browser
```

## 兼容性

- ✅ 与所有现有参数兼容
- ✅ 可与`--no-delays`组合使用
- ✅ 可与`--no-browser`组合使用
- ✅ 可与`--aggressive-delays`组合使用
- ⚠️ 与`--manual-captcha`功能部分互斥（跳过模式下不会触发手动处理）

## 更新历史

- **版本**: 2025-06-02 v2.1
- **更新**: 从简单跳过改为智能跳过策略
- **新增**: 自动化策略仍然执行，只跳过浏览器手动处理
- **改进**: 提高成功率同时保持快速执行
- **修改**: `_handle_429_error()`方法支持智能跳过逻辑
- **修改**: CAPTCHA处理逻辑支持智能跳过
- **更新**: 配置显示和示例命令
